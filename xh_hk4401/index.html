
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open and cheap DIY IP-KVM on Raspberry Pi">
      
      
      
        <meta name="author" content="Maxim Devaev">
      
      
        <link rel="canonical" href="https://pikvm.github.io/pikvm/xh_hk4401/">
      
      <link rel="icon" href="../_assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>XH-HK4401 4-port HDMI USB KVM Switch - PiKVM Handbook</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=arial,+sans-serif:300,400,400i,700%7Cmonospace&display=fallback">
        <style>:root{--md-text-font-family:"arial, sans-serif";--md-code-font-family:"monospace"}</style>
      
    
    
    
      <link rel="stylesheet" href="../_assets/user.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="" data-md-color-accent="pink">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#xh-hk4401-4-port-hdmi-usb-kvm-switch" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PiKVM Handbook" class="md-header__button md-logo" aria-label="PiKVM Handbook" data-md-component="logo">
      
  <img src="../_assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PiKVM Handbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              XH-HK4401 4-port HDMI USB KVM Switch
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/pikvm/pikvm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pikvm/pikvm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PiKVM Handbook" class="md-nav__button md-logo" aria-label="PiKVM Handbook" data-md-component="logo">
      
  <img src="../_assets/logo.png" alt="logo">

    </a>
    PiKVM Handbook
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pikvm/pikvm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pikvm/pikvm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" data-md-state="indeterminate" type="checkbox" id="__nav_1" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../v3/" class="md-nav__link">
        PiKVM v3 HAT guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../first_steps/" class="md-nav__link">
        First steps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Networking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" data-md-state="indeterminate" type="checkbox" id="__nav_2_1" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Internet access
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Internet access" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Internet access
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../port_forwarding/" class="md-nav__link">
        Port forwarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tailscale/" class="md-nav__link">
        Tailscale VPN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wifi/" class="md-nav__link">
        Setting up Wi-Fi
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Video
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Video" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Video
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../webrtc/" class="md-nav__link">
        H.264 / WebRTC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../video/" class="md-nav__link">
        Working with video
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../edid/" class="md-nav__link">
        Tuning HDMI EDID
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Peripheral devices
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Peripheral devices" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Peripheral devices
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" data-md-state="indeterminate" type="checkbox" id="__nav_4_1" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Keyboard & mouse
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Keyboard & mouse" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Keyboard & mouse
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mouse/" class="md-nav__link">
        Mouse modes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bluetooth_hid/" class="md-nav__link">
        Bluetooth HID
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arduino_hid/" class="md-nav__link">
        Arduino HID (USB, PS/2)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../msd/" class="md-nav__link">
        Mass Storage Drive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usb_ethernet/" class="md-nav__link">
        Ethernet-over-USB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usb_serial/" class="md-nav__link">
        Serial-over-USB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gpio/" class="md-nav__link">
        GPIO (pins, relays, lamps, etc)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Advanced usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Advanced usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vnc/" class="md-nav__link">
        Using VNC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multiport/" class="md-nav__link">
        Multiport KVM-over-IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wol/" class="md-nav__link">
        Wake-on-LAN the server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ipmi/" class="md-nav__link">
        IPMI & Redfish integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prometheus/" class="md-nav__link">
        Prometheus monitoring
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" data-md-state="indeterminate" type="checkbox" id="__nav_6" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3d_printing/" class="md-nav__link">
        Cases for 3D printing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../building_os/" class="md-nav__link">
        Building PiKVM OS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        HTTP API reference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connections" class="md-nav__link">
    Connections
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs-232-control-cable" class="md-nav__link">
    RS-232 control cable
  </a>
  
    <nav class="md-nav" aria-label="RS-232 control cable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#an-inverter-circuit" class="md-nav__link">
    An inverter circuit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inverting-usb-uart-adapter" class="md-nav__link">
    Inverting USB UART adapter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-ui-elements-to-control-the-kvm-switch" class="md-nav__link">
    Adding UI elements to control the KVM switch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#switching-between-hosts-in-the-ui" class="md-nav__link">
    Switching between hosts in the UI
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="xh-hk4401-4-port-hdmi-usb-kvm-switch">XH-HK4401 4-port HDMI USB KVM Switch<a class="headerlink" href="#xh-hk4401-4-port-hdmi-usb-kvm-switch" title="Permanent link">&para;</a></h1>
<p><img src="xh-hk4401.jpg" alt="drawing" width="300"/></p>
<p>This KVM is <a href="https://www.aliexpress.com/item/4000849336545.html">sold</a> under many names, and comes in two versions.
The only way these two versions differ is that one has one of its USB ports replaced with a PS/2 port. The
identifying feature is that they come with a small external control unit with 4 buttons. This controller is
connected to the main KVM via a micro USB cable, however this is <strong>NOT</strong> as USB connection.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Audio was not tested, it is assumed to be non-functional</p>
</div>
<h2 id="connections">Connections<a class="headerlink" href="#connections" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Connect the USB-A cable from the Raspberry Pi OTG port to to any of the USB ports on the XH-HK4401 switch. All 3/4 USB ports work exactly the same, internally they are just connected to a USB HUB.</p>
</li>
<li>
<p>Connect the HDMI out from the XH-HK4401 switch to the Raspberry Pi CSI-2 to HDMI input.</p>
</li>
<li>
<p>Connect host USB and HDMI cables from the XH-HK4401 switch to the machines to be managed per the switch instructions.</p>
</li>
<li>
<p>Finally see below for details about connecting to the control micro USB port. <strong>This it not a normal USB micro port.</strong></p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is a limitation in the underlying PiKVM software related to plugging video cables from a host which is already powered and connected to a monitor to a Raspberry Pi HDMI-CSI bridge. These limitations apply equally when using the XH-HK4401 KVM switch. If video is not present in PiKVM, try keeping all host machines off and connecting them directly to the XH-HK4401 switch before powering the hosts on.</p>
</div>
<h2 id="rs-232-control-cable">RS-232 control cable<a class="headerlink" href="#rs-232-control-cable" title="Permanent link">&para;</a></h2>
<p>The control unit communicates to the KVM using the RS-232 protocol (at 5v) not USB, and one of the following
solutions must be used.</p>
<h3 id="an-inverter-circuit">An inverter circuit<a class="headerlink" href="#an-inverter-circuit" title="Permanent link">&para;</a></h3>
<p>For this you will need:</p>
<ul>
<li>2x 2n7000 MOSFETs</li>
<li>2x 10K resistors</li>
<li>1x USB Micro connector, or sacrificial micro USB cable</li>
<li><em>Optional:</em> USB UART adapter</li>
</ul>
<p><img src="xh-hk4401_circuit.jpg" /></p>
<p>You can connect this either via a USB UART adapter, or directly to the Raspberry Pi: <code>GND -&gt; Pin 6</code>, <code>TX -&gt; Pin 8</code>, <code>RX -&gt; Pin 10</code>.
On the v3 PiKVM hat you will need to disable the UART jumpers to use the on-board UART.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please search online for USB pinouts to ensure you connect it properly.</p>
</div>
<h3 id="inverting-usb-uart-adapter">Inverting USB UART adapter<a class="headerlink" href="#inverting-usb-uart-adapter" title="Permanent link">&para;</a></h3>
<p>Some USB UART adapters have the rare feature to invert the logic level of the RX/TX signals. For example the FTDI FT232 can
be configured via the FTDI configuration GUI to do this. With such an adapter, the circuit above is not required. All you
need is to connect it to a micro-USB connector.</p>
<p>In order to invert the RX/TX signals, you can use <a href="https://ftdichip.com/utilities/#ft_prog">ft_prog</a> and set the following settings:</p>
<p><img src="ft232_config.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These options will only be available on UART adapters with genuine FTDI chips. There are a lot of cheap fakes on the
market that either lack this option, or will prevent you from changing their settings. To avoid getting a fake
ensure you always purchase from a reputable store and brand (Adafruit, Sparkfun, etc.), Amazon <strong>is not</strong> a
reputable store.</p>
</div>
<h2 id="adding-ui-elements-to-control-the-kvm-switch">Adding UI elements to control the KVM switch<a class="headerlink" href="#adding-ui-elements-to-control-the-kvm-switch" title="Permanent link">&para;</a></h2>
<p>The UI can be updated to add buttons to switch between KVM inputs and indicators for which input is currently selected.  The instructions below will make these available in the PiKVM UI after clicking the "GPIO" menu button in the KVM view.</p>
<ol>
<li>
<p>SSH into PiKVM</p>
</li>
<li>
<p>Enable read-write mode on the sd card via <code>rw</code></p>
</li>
<li>
<p>Edit the <code>/etc/kvmd/override.yaml</code> file and include the following. Note the assumption that you are using a USB UART present on <code>/dev/ttyUSB0</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">kvmd</span><span class="p">:</span>
    <span class="nt">gpio</span><span class="p">:</span>
        <span class="nt">drivers</span><span class="p">:</span>
            <span class="nt">hk</span><span class="p">:</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xh_hk4401</span>
                <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/dev/ttyUSB0</span>
        <span class="nt">scheme</span><span class="p">:</span>
            <span class="nt">ch0_led</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">input</span>
            <span class="nt">ch1_led</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">input</span>
            <span class="nt">ch2_led</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">input</span>
            <span class="nt">ch3_led</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">input</span>
            <span class="nt">ch0_button</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output</span>
                <span class="nt">switch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
            <span class="nt">ch1_button</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output</span>
                <span class="nt">switch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
            <span class="nt">ch2_button</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output</span>
                <span class="nt">switch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
            <span class="nt">ch3_button</span><span class="p">:</span>
                <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hk</span>
                <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
                <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output</span>
                <span class="nt">switch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">view</span><span class="p">:</span>
            <span class="nt">table</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&quot;#Input</span><span class="nv"> </span><span class="s">1&quot;</span><span class="p p-Indicator">,</span> <span class="nv">ch0_led</span><span class="p p-Indicator">,</span> <span class="nv">ch0_button</span><span class="p p-Indicator">]</span>
                <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&quot;#Input</span><span class="nv"> </span><span class="s">2&quot;</span><span class="p p-Indicator">,</span> <span class="nv">ch1_led</span><span class="p p-Indicator">,</span> <span class="nv">ch1_button</span><span class="p p-Indicator">]</span>
                <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&quot;#Input</span><span class="nv"> </span><span class="s">3&quot;</span><span class="p p-Indicator">,</span> <span class="nv">ch2_led</span><span class="p p-Indicator">,</span> <span class="nv">ch2_button</span><span class="p p-Indicator">]</span>
                <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&quot;#Input</span><span class="nv"> </span><span class="s">4&quot;</span><span class="p p-Indicator">,</span> <span class="nv">ch3_led</span><span class="p p-Indicator">,</span> <span class="nv">ch3_button</span><span class="p p-Indicator">]</span>
</code></pre></div>
</li>
<li>
<p>Return to read-only mode for the sd card via <code>ro</code></p>
</li>
<li>
<p>Restart the kvmd service: <code>systemctl restart kvmd</code></p>
</li>
</ol>
<h2 id="switching-between-hosts-in-the-ui">Switching between hosts in the UI<a class="headerlink" href="#switching-between-hosts-in-the-ui" title="Permanent link">&para;</a></h2>
<p>To switch between hosts, enter the KVM UI and click the "GPIO" menu. You should see 4 inputs, one of which will have a green circle indicating it is currently selected. Click the other inputs to change the selected host.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018-2021 Maxim Devaev
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.expand", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>